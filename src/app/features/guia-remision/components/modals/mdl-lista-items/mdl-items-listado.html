<div class="grid grid-cols-3 gap-4">
    <div class="">
        <label class="text-xs text-gray-500 font-semibold">C贸digo</label>
        <p-iconfield>
            <p-inputicon class="pi pi-search" />
            <input pSize="small" fluid type="text" pInputText placeholder="C贸digo" />
        </p-iconfield>           
    </div>
    <div class="col-span-2">
        <label class="text-xs text-gray-500 font-semibold">Descripci贸n</label>
        <p-iconfield>
            <p-inputicon class="pi pi-search" />
            <input pSize="small" fluid type="text" pInputText placeholder="Descripci贸n" />
        </p-iconfield> 
    </div>
</div>

<div class="pt-5">
    <p-table
        size="small"
        #datatable
        [showCurrentPageReport]="true"
        [columns]="cols"
        [value]="data"
        [(selection)]="selectedItems"
        selectionMode="multiple"
        [tableStyle]="{ 'min-width': '100px' }"
        [scrollable]="true"
        [showLoader]="false"
        [resizableColumns]="true"
        columnResizeMode="expand"
      
        [lazy]="true"
        [rowHover]="true"
        [paginator]="true"
        [rows]="data.length"
        [totalRecords]="data.length"
        [rowsPerPageOptions]="[5, 10, 25, 50]"
        [first]="5"
        scrollHeight="400px"
        class="border-0! text-xs!"
        paginatorStyleClass="justify-end! text-xs! p-paginator-xs rounded-none!"
        
        >
        
            <ng-template pTemplate="header" let-columns>
                    <tr>
                        @for (col of columns; track $index) {
                            <th 
                            pResizableColumn 
                            [pSortableColumn]="col.sort ? col.field : undefined" 
                            class="text-nowrap text-xs text-gray-500! font-semibold py-4!">
                                <div class="flex items-center gap-2">
                                    {{ col.header }}
                                    @if(col.sort){<p-sortIcon [field]="col.field" />}
                                </div>
                            </th>
                        }
                    </tr>
            </ng-template>

            <ng-template pTemplate="body" let-rowData let-columns="columns">
                @if(ldData){
                    <tr>
                        @for (col of columns; track $index) {
                            <td>
                                <p-skeleton [width]="$index == 0 ? '20px' : '100%'" height="20px"></p-skeleton>
                            </td>
                        }
                    </tr>
                }@else {
                    <tr [ngClass]="{ 'p-highlight': isSelected(rowData) }">
                        @for (col of columns; track $index) {
                            @switch(col.field){
                                @case('code'){
                                    <td class="text-nowrap font-light! truncate w-25!" >{{ rowData[col.field] }}</td>
                                }
                                @case('unit_mount'){
                                  <td class="text-nowrap font-light! text-end! w-25!">{{ rowData[col.field] | currency:'':'':'1.2-2':'es-PE' }}</td>
                                }
                                @case('unit_of_measure')
                                @case('currency'){
                                  <td class="text-nowrap font-light! truncate text-center!" >{{ rowData[col.field] }}</td>
                                }
                                @case('selected'){
                                    <td class="text-center!">
                                        @if(!isSelected(rowData)){
                                            <p-button (click)="evtToggleSelected(rowData, true)" pTooltip="Seleccionar" tooltipPosition="top" tooltipStyleClass="text-[10px]!" class="text-xs!" styleClass="w-6! h-6!" size="small" icon="pi pi-plus text-xs! font-bold!" rounded="true" severity="secondary" />
                                        }@else {
                                            <p-button (click)="evtToggleSelected(rowData, false)" pTooltip="Deseleccionar" tooltipPosition="top" tooltipStyleClass="text-[10px]!" class="text-xs!" styleClass="w-6! h-6!" size="small" icon="pi pi-check text-xs! font-bold!" rounded="true" severity="success" />
                                        }
                                    </td>
                                }
                                @default {
                                    <td class="text-nowrap font-light! truncate" >{{ rowData[col.field] }}</td>
                                }
                            }
                        }
                    </tr>
                }
            </ng-template>
    </p-table>
</div>

<div class="flex gap-2 justify-end pt-6">
    <p-button size="small" label="Cancelar" severity="secondary"></p-button>
    <p-button (click)="evtSelect()" [disabled]="!selectedItems.length" size="small" label="Agregar" severity="primary"></p-button>
</div>