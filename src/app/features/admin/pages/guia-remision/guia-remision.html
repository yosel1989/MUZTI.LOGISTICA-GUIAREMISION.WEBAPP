<div class="p-4 relative">
    <form [formGroup]="fromGroup" (ngSubmit)="evtOnSubmit()" class="flex flex-col gap-4">

        <div class="grid grid-cols-3 gap-4">
            <div class="col-span-2 flex flex-col gap-4">

                @if(selectTipoGuiaComponent && selectTipoGuiaComponent.tipoGuiaSelected === tipoGuia.transportista){
                    <p-tabs value="0">
                        <p-tablist>
                            <p-tab value="0">Remitente</p-tab>
                            <p-tab value="1">Destinatario</p-tab>
                        </p-tablist>
                    </p-tabs>
                }

                <div class="grid grid-cols-2">
                    <div>
                        <app-select-tipo-guia #selectTipoGuia classLabel="text-xs text-gray-500 font-semibold"></app-select-tipo-guia>
                    </div>
                </div>

                <!-- Tipo de Traslado -->
                @if(selectTipoGuiaComponent && selectTipoGuiaComponent.tipoGuiaSelected === tipoGuia.remitente){
                <div>
                    <app-select-motivo-traslado [control]="f.tipo_traslado" classLabel="text-xs text-gray-500 font-semibold"></app-select-motivo-traslado>
                </div>
                }

                @if(selectTipoGuiaComponent && selectTipoGuiaComponent.tipoGuiaSelected === tipoGuia.remitente){
                <div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <app-select-tipo-documento [control]="f.tipo_documento" classLabel="text-xs text-gray-500 font-semibold"></app-select-tipo-documento>
                        </div>
                        <div>
                            <label  class="text-xs">Nro. de Documento *</label>
                            <input onlyNumber placeholder="Nro. de Documento *" pSize="small" fluid pInputText />
                        </div>
                    </div>
                    <div>
                        <label  class="text-xs">Nombres y Apellidos *</label>
                        <input placeholder="Nombres y Apellidos *" pSize="small" fluid pInputText />
                    </div>

                    <div>
                        <label  class="text-xs">Dirección</label>
                        <input placeholder="Dirección" pSize="small" fluid pInputText />
                    </div>
                </div>
                }
                
                <div>
                    <label class="text-xs">Tipo de Guía de Remisión</label>
                    <p-select size="small" fluid  optionLabel="name" class="p-inputwrapper-filled" placeholder="--SELECCIONAR--"></p-select>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label  class="text-xs">Tipo de Documento</label>
                        <p-select size="small" fluid optionLabel="name" class="p-inputwrapper-filled" placeholder="--SELECCIONAR--"></p-select>
                    </div>
                    <div>
                        <label  class="text-xs">Nro. de Documento *</label>
                        <input placeholder="Nro. de Documento *" pSize="small" fluid pInputText />
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <app-select-departamento [control]="f.departamento" classLabel="text-xs text-gray-500 font-semibold"></app-select-departamento>
                    </div>
                    <div>
                        <app-select-provincia [control]="f.provincia" [idUbigeoDepartamento]="f.departamento.value" classLabel="text-xs text-gray-500 font-semibold"></app-select-provincia>
                    </div>
                    <div>
                        <app-select-distrito [control]="f.distrito" [idUbigeoProvincia]="f.provincia.value" classLabel="text-xs text-gray-500 font-semibold"></app-select-distrito>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label  class="text-xs">Email *</label>
                        <input placeholder="Email *" pSize="small" fluid pInputText />
                    </div>

                    <div>
                        <label  class="text-xs">Email *</label>
                        <input placeholder="Email *" pSize="small" fluid pInputText />
                    </div>

                    <div>
                        <!--<div>
                            <label  class="text-xs">Email *</label>
                            <input placeholder="Email *" pSize="small" fluid pInputText />
                        </div>-->
                        <p-button label="Añadir contacto" link />
                    </div>
                </div>

                <div>
                    <div>
                        <label class="text-xs">Nombres y Apellidos *</label>
                        <input placeholder="Nombres y Apellidos *" pSize="small" fluid pInputText />
                    </div>
                </div>
                
                <div>
                    <div>
                        <label class="text-xs">Dirección *</label>
                        <input placeholder="Dirección *" pSize="small" fluid pInputText />
                    </div>
                </div>
                
                <div>
                    <label for="city" class="text-xs">Tipo de Guía de Remisión</label>
                    <p-select size="small" fluid optionLabel="name" class="p-inputwrapper-filled" placeholder="--SELECCIONAR--"></p-select>
                </div>
                
                <div>
                    <label for="city" class="text-xs">Tipo de Guía de Remisión</label>
                    <p-select size="small" [fluid]="" optionLabel="name" class="p-inputwrapper-filled" placeholder="--SELECCIONAR--"></p-select>
                </div>
            </div>

            <div class="flex flex-col gap-4">
                <div class="">
                    <label  class="block text-xs">Fecha de emisión</label>
                    <p-datepicker [maxDate]="today" [minDate]="last" formControlName="fecha_emision" size="small" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay" />
                </div>

                @if(selectTipoGuiaComponent?.tipoGuiaSelected === tipoGuia.remitente){
                    <div>
                        <label class="text-[11px]! h-4.5! flex gap-x-2 items-center text-gray-500 font-semibold">N° de registro MTC <ng-icon name="heroQuestionMarkCircleSolid" class="text-[14px]! min-w-3.25!" pTooltip="Aquí deberás ingresar el peso bruto de la carga a transportar, por ahora, el peso solo puede ser representado en kilogramos o toneladas." tooltipStyleClass="text-xs! text-center" tooltipPosition="top"/></label>
                        <input  placeholder="N° de registro MTC" pSize="small" fluid pInputText />
                    </div>
                }

                <div class="border border-gray-400 p-4">
                    <div class="flex items-center gap-1">
                        <label for="" class="text-[14px] font-semibold text-primary">Documentos Relacionados:</label>
                        <ng-icon name="heroQuestionMarkCircleSolid" class="min-w-3.25!" pTooltip="Si quieres agregar algún documento asociado a tu guía de remisión, puedes añadirlo desde aquí y la información se mostrará en el PDF final." tooltipStyleClass="text-xs! text-center" tooltipPosition="top"/>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex flex-col gap-4">
            <app-tab-datos-envio-proveedor 
            [tipoGuia]="selectTipoGuiaComponent?.tipoGuiaSelected!" 
            [motivoTraslado]="f.tipo_traslado.value" 
            #tabDatosEnvioProveedor></app-tab-datos-envio-proveedor>

            <app-tab-origen-destino #tabOrigenDestino></app-tab-origen-destino>

            <app-section-producto-listado #sectionProductoListado></app-section-producto-listado>
        </div>
    </form>
</div>

<div class="sticky bottom-0 p-4 bg-white text-end border-t shadow-lg! border-gray-300 z-20">
    <p-button class="ml-auto" styleClass="px-8!" icon="pi pi-file" type="submit" label="Emitir Guía" severity="primary" (onClick)="evtOnSubmit()"></p-button>
</div>
